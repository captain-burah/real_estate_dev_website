
    function setCookie(name, value, daysToExpire) {
        var expires = "";
        
        if (daysToExpire) {
            var date = new Date();
            date.setTime(date.getTime() + (daysToExpire * 5 * 60 * 1000));
            expires = "; expires=" + date.toUTCString();
        }
        
        document.cookie = name + "=" + value + expires + "; path=/";
    };

    // Function to get a specific cookie by name
    function getCookie(cookieName) {
        var name = cookieName + "=";
        var decodedCookie = decodeURIComponent(document.cookie);
        var cookieArray = decodedCookie.split(';');

        for (var i = 0; i < cookieArray.length; i++) {
            var cookie = cookieArray[i].trim();
            if (cookie.indexOf(name) === 0) {
                return cookie.substring(name.length, cookie.length);
            }
        }

        return null; // Return null if the cookie is not found
    };

    //---OPEN A MODAL
    function openModal(key) {
        document.getElementById(key).showModal();
        document.body.setAttribute('style', 'overflow: hidden;');
        document.getElementById(key).children[0].scrollTop = 0;
        document.getElementById(key).children[0].classList.remove('opacity-0');
        document.getElementById(key).children[0].classList.add('opacity-100')
    }

    //---CLOSE A MODAL
    function modalClose(key) {
        document.getElementById(key).children[0].classList.remove('opacity-100');
        document.getElementById(key).children[0].classList.add('opacity-0');
        setTimeout(function () {
            document.getElementById(key).close();
            document.body.removeAttribute('style');
        }, 100);
    }

    
    $(document).ready(function () {           

        var pid = $("#pid").val();        //--get project id
        var cookie_id_reg = '_' + pid + '_q2vWT4junrLR';  //---append the registration cookie code with project id to separate it from others
        var cookie_id_broc = '_' + pid + '_rO13oN8QOv';  //---append the brochure cookie code with project id to separate it from others
        var cookie_broc_verifying = '_' + pid + '_qGSasA033X99Fhbs';  //---append the brochure verification cookie code with project id to separate it from others

        var data_verifiying = getCookie('cookie_broc_verifying'); //---CHECK FOR VERIFY COOKIE
        var data_form_verification_code;

        if(data_verifiying) {
            modalClose('mymodalcentered-brochure-register');
            openModal('mymodalcentered-brochure-verify');
        }
        








        //---WHEN USER SUBMITS REGISTRATION INTEREST
        if (getCookie(cookie_id_reg)) {
            var successView = document.getElementById("form_ready");
            successView.classList.add("hidden");

            var formView = document.getElementById("form_submitted");
            formView.classList.remove("hidden");
        } else {
            $('#new-project-details-desktop-form').on('submit', function(e){

                /**
                 * INITIATE AN AJAX SCRIPT FOR THE FORM SUBMISSION
                 * ALONG WITH POST ROUTE METHOD AND URL. IF RESPONSE
                 * IS A SUCCESS DISPLAY THE THANK YOU MODAL AND
                 * UPDATE THE FORM SESSION IN SESSION-STORAGE OF BROWSER
                 *
                */
                var successView = document.getElementById("form_ready");
                successView.classList.add("hidden");
    
                var formView = document.getElementById("form_submitted");
                formView.classList.remove("hidden");

                e.preventDefault(); //---cancel default form submissions
                var formData = new FormData(this); //---get alll the form data here

                $.ajaxSetup({
                    headers: {
                        'X-CSRF-TOKEN': $('meta[name="XSRF-TOKEN"]').attr('content')
                    }
                });
                $.ajax({
                    type:'POST',
                    headers: //---set the headers for cross-origin policies between domains
                    {
                        'X-CSRF-TOKEN': $('meta[name="XSRF-TOKEN"]').attr('content'),
                        'Access-Control-Allow-Origin': 'https://esnaad.com/en/project-detail-inquiry'
                    },
                    url: "/en/project-detail-inquiry",
                    data: formData,
                    processData: false,
                    contentType: false,
                    success:function(data) 
                    {
                        if($.isEmptyObject(data.error)){ //---if success
                            var pid = $("#pid").val();  //--get project id
                            var cookie_id = '_' + pid + '_q2vWT4junrLR';  //---append the brochure code with project id to separate it from others
                            document.location.href = '/en/project-details/thanks'; //---redirect to thank you page for seo
                        }else{
                            printErrorMsg(data.error);//---show error
                        }
                    }
                });

            });
        }
        









        //---WHEN USER SUBMITS BROCHURE DOWNLOAD INFORMATION
        $('#new-project-details-desktop-brochure-form').on('submit', function(e){

            // var redirectWindow = window.open('esnaad.com/home/The_Spark_by_ESNAAD_Brochure.pdf', '_blank');
            // redirectWindow.location;

            var borchure_expression_check = document.getElementById('borchure_expression_check').value;
            if(borchure_expression_check != '12x'){
                var error_modal = document.getElementById('session-msg-1');
                var error_modal_bg = document.getElementById('session-msg-1-bg');
                error_modal.setAttribute('open');
                error_modal_bg.classList.remove('opacity-0');
                error_modal_bg.classList.add('opacity-100');
            }


            /**
             * INITIATE AN AJAX SCRIPT FOR THE FORM SUBMISSION
             * ALONG WITH POST ROUTE METHOD AND URL. IF RESPONSE
             * IS A SUCCESS DISPLAY THE THANK YOU MODAL AND
             * UPDATE THE FORM SESSION IN SESSION-STORAGE OF BROWSER
             *
            */

            /** GENERATE CODE*/
            data_form_verification_code = Math.floor(1000 + Math.random() * 9000);
            data_form_verification_code2 = Math.floor(100000000000 + Math.random() * 9000000000);
            // console.log(data_form_verification_code2);
            var data_cookie_code = "" + data_form_verification_code2 + data_form_verification_code; 
            
            /** SET A COOKIE FOR VERIFICATION CODE*/
            setCookie("_W24KyM7d8u22rxFA", data_cookie_code, 1);

            /** ASSIGN CODE TO INPUT*/
            document.getElementById('MAVmKG09eI4aX8uv').value = data_form_verification_code;

            e.preventDefault(); //---cancel default form submissions
            var formData = new FormData(this); //---get alll the form data here

            document.getElementById("submitFormBrochure").disabled = true;
            document.getElementById("submitFormBrochure").style.background='#fff';
            document.getElementById("submitFormBrochure").style.color='#cccccc';
            document.getElementById('submitFormBrochure').innerHTML = "Verifying";
            
            $.ajaxSetup({
                headers: {
                    'X-CSRF-TOKEN': $('meta[name="XSRF-TOKEN"]').attr('content')
                }
            });
            $.ajax({
                type:'POST',
                headers: //---set the headers for cross-origin policies between domains
                {
                    'X-CSRF-TOKEN': $('meta[name="XSRF-TOKEN"]').attr('content'),
                    'Access-Control-Allow-Origin': 'https://esnaad.com/en/project-detail-brochure-download'
                },
                url: "/en/project-detail-brochure-download",
                data: formData,
                processData: false,
                contentType: false,
                success:function(data) 
                {
                    if($.isEmptyObject(data.error)){ //---if success
                        var pid = $("#pid").val();  //--get project id
                        var cookie_id = '_' + pid + '_qGSasA033X99Fhbs';  //---append the brochure code with project id to separate it from others
                        setCookie(cookie_id, true, 1); //---set the cookie
                        modalClose('mymodalcentered-brochure-register');
                        // var brochure_link = $("#brochurelink").val();
                        // var brochure_link = "https://esnaad.com/home/the-spark-by-esnaad.pdf";
                        // document.location.href = brochure_link; //---redirect to thank you page for seo
                        var redirectWindow = window.open('https://esnaad.com/home/the-spark-by-esnaad.pdf', '_blank');
                        redirectWindow.location;

                    }else{
                        printErrorMsg(data.error);//---show error
                    }
                }
            });

        });



        






        //---WHEN USER SUBMITS THE VERIFICATION CODE
        $('#verificationFormSubmit').on('click', function(e){

            e.preventDefault();

            document.getElementById("verificationFormSubmit").disabled = true;
            document.getElementById("verificationFormSubmit").style.background='#fff';
            document.getElementById("verificationFormSubmit").style.color='#cccccc';
            document.getElementById('verificationFormSubmit').innerHTML = "Verifying";


            /** GET THE VERIFICATION CODE FROM THE COOKIES*/
            var data_form_verification_code_cookies = getCookie('_W24KyM7d8u22rxFA');
            
            //-- DECRYPOT THE COOKIE AND RETRIEVE THE 4DIGIT CODE.
            var decryptCookie = data_form_verification_code_cookies.toString().slice(12);
            
            //---RETRIEVE THE USER ENTERED VERIFICATION CODE TO MATCH
            var data_form_verification_code_user = document.getElementById('applicant_code').value;

            if(data_form_verification_code_user == decryptCookie ) {

                //---IF THE TWO CODES MATCH, THEN PROCEED TO GET THE BROCHURE FORM DETAILS
                var formData = new FormData($('#new-project-details-desktop-brochure-form')[0]);

                $.ajax({
                    type:'POST',
                    headers: {
                        'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content'),
                        'Access-Control-Allow-Origin': 'https://esnaad.com/en/project-detail-brochure-download'
                    },
                    url:"/en/project-detail-brochure-download",
                    data: formData,
                    processData: false,
                    contentType: false,
                    success:function(data) 
                    {
                        if($.isEmptyObject(data.error)){ //---if success
                            var pid = $("#pid").val();  //--get project id
                            var cookie_id = '_' + pid + '_rO13oN8QOv';  //---append the brochure code with project id to separate it from others
                            setCookie(cookie_id, true, 1); //---set the cookie
                            var brochure_link = $("#brochurelink").val();
                            document.location.href = brochure_link; //---redirect to thank you page for seo
                        }else{
                            printErrorMsg(data.error);//---show error
                        }
                    }
                });
                
                
            } else {
                document.getElementById("verificationFormSubmit").disabled = false;
                document.getElementById("verificationFormSubmit").style.background='#000';
                document.getElementById("verificationFormSubmit").style.color='#fff';
                document.getElementById("verificationFormSubmit").style.border='none';
                document.getElementById('verificationFormSubmit').innerHTML = "Verify";
            }

            
        });          
    });
