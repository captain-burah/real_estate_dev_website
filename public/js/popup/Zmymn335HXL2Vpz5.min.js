


    function setCookie(name, value, daysToExpire) {
        var expires = "";
        
        if (daysToExpire) {
            var date = new Date();
            date.setTime(date.getTime() + (daysToExpire * 5 * 60 * 1000));
            expires = "; expires=" + date.toUTCString();
        }
        
        document.cookie = name + "=" + value + expires + "; path=/";
    };

    // Function to get a specific cookie by name
    function getCookie(cookieName) {
        var name = cookieName + "=";
        var decodedCookie = decodeURIComponent(document.cookie);
        var cookieArray = decodedCookie.split(';');

        for (var i = 0; i < cookieArray.length; i++) {
            var cookie = cookieArray[i].trim();
            if (cookie.indexOf(name) === 0) {
                return cookie.substring(name.length, cookie.length);
            }
        }

        return null; // Return null if the cookie is not found
    };


    // $(document).ready(function () {           
    //     if (!getCookie('_GJiIH16wT6TgFJv')) {
    //         console.log('no');
    //         const element2 = document.getElementById('newsletter-popup-modal');
    //         console.log(element2.dataset.modelOpen = true);
    //         // element2.dataset.modelOpen = true;
    //     }
    // });

    // Check if the form has been submitted before
    // if (localStorage.getItem('subscriptionSubmitted')) {
    //     disableForm();
    // }

    

    $('#subscriptionFormPopup').on('submit', function(e){
        e.preventDefault();

        document.getElementById("submitPopupButton").disabled = true;
        document.getElementById('submitPopupButton').style.display = 'none';
        document.getElementById('submitPopupVerifying').style.display = 'inline-block';

        // if (localStorage.getItem('subscriptionSubmitted')) {
        //     // alert('You have already submitted the form');
            
        //     return;
        // }

        var formData = new FormData(this);

        $.ajaxSetup({
            headers: {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content'),
                'Access-Control-Allow-Origin': 'https://esnaad.com//en/subscription-form',
                'authkey': 'YOUR_SECRET_KEY',
            }
        });

        $.ajax({
            type:'POST',
            headers: //---set the headers for cross-origin policies between domains
            {
                'X-CSRF-TOKEN': $('meta[name="XSRF-TOKEN"]').attr('content'),
                'Access-Control-Allow-Origin': 'https://esnaad.com//en/subscription-form',
                'authkey': 'YOUR_SECRET_KEY',
            },
            url: "/en/subscription-form",
            data: formData,
            processData: false,
            contentType: false,
            success:function(data)
            {
                if($.isEmptyObject(data.error)){
                    setCookie("_GJiIH16wT6TgFJv", true, 1);
                    document.getElementById('newsletter-ty-section').style.display = 'block';
                    document.getElementById('newsletter-form-section').style.display = 'none';
                }else{
                    printErrorMsg(data.error);
                    alert(data.error);
                }
            }
        });

        // Simulate a successful submission
        // alert('Subscription successful!');

        // Disable the form to prevent further submissions
        // disableForm();

        // Store the submission status in local storage
        // localStorage.setItem('subscriptionSubmitted', 'true');
    });



    function disableForm() {
        document.getElementById('submitButton').disabled = true;
    }
